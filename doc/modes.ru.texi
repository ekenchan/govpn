@node Режимы работы
@section Режимы работы

Есть три режима работы и два режима обеспечения конфиденциальности данных.

Три режима работы предоставляют компромиссы между потреблением ресурсов
и эффективностью.

@table @asis

@item Режим по-умолчанию.

Пакеты с данными зашифрованы и аутентифицированы и посылаются сразу же.
Это наиболее эффективный режим с минимальными накладными расходами и
задержками.

@verbatim
         +-----------+   +-----+         +---------+    +------+
         |  DATA     |   |DATA |         |  DATA   |    | DATA |
         +-----------+   +-----+         +---------+    +------+

---------------------------------------------------------------------------------------> t
@end verbatim

@item @ref{Noise, Шумовой} режим.

Этот режим прячет длины пакетов. Как правило, он потребляет больше
трафика.

@verbatim
 +------const------+        +------const------+    +------const------+
/                   \      /                   \  /                   \

+------+------------+      +---------+---------+  +-------------+-----+
| DATA | NOISE      |      | DATA    | NOISE   |  | DATA        |NOISE|
+------+------------+      +---------+---------+  +-------------+-----+

---------------------------------------------------------------------------------------> t
@end verbatim

@item Режим постоянной @ref{CPR, скорости пакетов}.

Этот режим ещё и прячет временные характеристики пакетов. Он может
увеличить задержки и вставлять пустые шумовые пакеты.

@verbatim
 +------const------+             +------const------+             +------const------+
/                   \           /                   \           /                   \

+------+------------+           +---------+---------+           +-------------------+
| DATA | NOISE      |<--const-->| DATA    | NOISE   |<--const-->|       NOISE       |
+------+------------+           +---------+---------+           +-------------------+

---------------------------------------------------------------------------------------> t
@end verbatim

@end table

Режимы обеспечения конфиденциальности также являются компромиссом между
эффективностью и потреблением ресурсов.

@table @asis

@item @ref{Transport, Стандартный} режим.

Шифрование и аутентификация производятся используя хорошо известные
алгоритмы. Это очень эффективный режим. Он генерирует пакеты неотличимые
от шума.

@verbatim
+---------------------------------------------------------+
|                       PACKET                            |
|                                                         |
|  +-----+ +---------------------------+   +-------+      |
|  | TAG |/         CIPHERTEXT          \ /  NONCE  \     |
|  +-----+|-----------------------------||-----------|    |
|         |                             ||           |    |
+---------------------------------------------------------+
          |                             ||           |
          |-----------------------------||-----------|
          |          ENCRYPTION         ||    MAC    |
          +------------+---+------------++-----------+
          |    DATA    |PAD|    ZEROS   ||  SERIAL   |
          +------------+---+------------++-----------+
@end verbatim

@item @ref{Encless, Нешифрованный} режим.

Этот режим не использует какие-либо функции шифрования. Вместо этого
используется Chaffing-and-Winnowing кодирование поверх AONT
(всё-или-ничего) пакета данных. Этот режим потребляет ощутимо больше
ресурсов и трафика. Он также генерирует неотличимые от шума пакеты.

@verbatim
+----------------------------------------------------+
|                  PACKET                            |
|                                                    |
|     +---------------------------+  +---------+     |
|    /         CIPHERTEXT          \/   NONCE   \    |
|    |-----------------------------||-----------|    |
|    |                             ||           |    |
+----------------------------------------------------+
     |                             ||           |
     |--------+--------------------||-----------|
     |Chaffing|        AONT        ||    MAC    |
     +--------+---+---+------------++-----------+
     |    DATA    |PAD|    ZEROS   ||  SERIAL   |
     +------------+---+------------++-----------+
@end verbatim

@end table
